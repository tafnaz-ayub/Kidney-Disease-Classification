[2025-07-07 05:25:09,794: INFO: main: Welcome to our custom log]
[2025-07-10 04:51:27,795: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 04:51:27,823: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 04:51:27,827: INFO: common: craeted directory at:artifacts_root]
[2025-07-10 04:51:27,831: INFO: common: craeted directory at:artifacts/data_ingestion]
[2025-07-10 04:51:27,834: INFO: 2112224593: Downloading data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-07-10 05:04:35,482: INFO: 2112224593: Downloaded data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-07-10 05:13:17,438: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 05:13:17,443: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 05:13:17,446: INFO: common: craeted directory at:artifact]
[2025-07-10 05:13:17,448: INFO: common: craeted directory at:artifacts/data_ingestion]
[2025-07-10 05:13:17,452: INFO: 4158922119: Downloading data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-07-10 05:30:31,857: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 05:30:31,874: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 05:30:31,877: INFO: common: craeted directory at:artifacts]
[2025-07-10 05:30:31,880: INFO: common: craeted directory at:artifacts/data_ingestion]
[2025-07-10 05:30:31,884: INFO: 4158922119: Downloading data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-07-10 05:37:04,169: INFO: 4158922119: Downloaded data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-07-10 05:59:21,573: INFO: main: >>>>> stage Data Ingestion Stage started <<<<<<<]
[2025-07-10 05:59:21,574: ERROR: main: DataIngestionTrainingPipeline.main() missing 1 required positional argument: 'self']
Traceback (most recent call last):
  File "C:\Users\tafnaz a\Documents\PLACEMENT TRAINING\Kidney-Disease-Classification\main.py", line 10, in <module>
    obj.main()
TypeError: DataIngestionTrainingPipeline.main() missing 1 required positional argument: 'self'
[2025-07-10 05:59:46,616: INFO: main: >>>>> stage Data Ingestion Stage started <<<<<<<]
[2025-07-10 05:59:46,619: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 05:59:46,620: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 05:59:46,622: INFO: common: craeted directory at:artifacts]
[2025-07-10 05:59:46,623: INFO: common: craeted directory at:artifacts/data_ingestion]
[2025-07-10 05:59:46,624: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-07-10 06:07:21,077: ERROR: main: ('Connection broken: IncompleteRead(1182498620 bytes read, 444331096 more expected)', IncompleteRead(1182498620 bytes read, 444331096 more expected))]
Traceback (most recent call last):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 779, in _error_catcher
    yield
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 925, in _raw_read
    raise IncompleteRead(self._fp_bytes_read, self.length_remaining)
urllib3.exceptions.IncompleteRead: IncompleteRead(1182498620 bytes read, 444331096 more expected)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\models.py", line 820, in generate
    yield from self.raw.stream(chunk_size, decode_content=True)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 1091, in stream
    data = self.read(amt=amt, decode_content=decode_content)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 1008, in read
    data = self._raw_read(amt)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 903, in _raw_read
    with self._error_catcher():
  File "C:\ProjectWork\envs\kidney\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 803, in _error_catcher
    raise ProtocolError(arg, e) from e
urllib3.exceptions.ProtocolError: ('Connection broken: IncompleteRead(1182498620 bytes read, 444331096 more expected)', IncompleteRead(1182498620 bytes read, 444331096 more expected))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\tafnaz a\Documents\PLACEMENT TRAINING\Kidney-Disease-Classification\main.py", line 10, in <module>
    obj.main()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\pipeline\stage_01_data_ingestion.py", line 14, in main
    data_ingestion.download_file()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\components\data_ingestion.py", line 31, in download_file
    raise e
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\components\data_ingestion.py", line 26, in download_file
    gdown.download(prefix+file_id,zip_download_dir)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\gdown\download.py", line 368, in download
    for chunk in res.iter_content(chunk_size=CHUNK_SIZE):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\models.py", line 822, in generate
    raise ChunkedEncodingError(e)
requests.exceptions.ChunkedEncodingError: ('Connection broken: IncompleteRead(1182498620 bytes read, 444331096 more expected)', IncompleteRead(1182498620 bytes read, 444331096 more expected))
[2025-07-10 06:08:00,098: INFO: main: >>>>> stage Data Ingestion Stage started <<<<<<<]
[2025-07-10 06:08:00,100: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 06:08:00,102: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 06:08:00,103: INFO: common: craeted directory at:artifacts]
[2025-07-10 06:08:00,104: INFO: common: craeted directory at:artifacts/data_ingestion]
[2025-07-10 06:08:00,105: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-07-10 06:51:32,450: ERROR: main: ('Connection broken: IncompleteRead(218622722 bytes read, 1408206994 more expected)', IncompleteRead(218622722 bytes read, 1408206994 more expected))]
Traceback (most recent call last):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 779, in _error_catcher
    yield
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 925, in _raw_read
    raise IncompleteRead(self._fp_bytes_read, self.length_remaining)
urllib3.exceptions.IncompleteRead: IncompleteRead(218622722 bytes read, 1408206994 more expected)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\models.py", line 820, in generate
    yield from self.raw.stream(chunk_size, decode_content=True)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 1091, in stream
    data = self.read(amt=amt, decode_content=decode_content)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 1008, in read
    data = self._raw_read(amt)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 903, in _raw_read
    with self._error_catcher():
  File "C:\ProjectWork\envs\kidney\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 803, in _error_catcher
    raise ProtocolError(arg, e) from e
urllib3.exceptions.ProtocolError: ('Connection broken: IncompleteRead(218622722 bytes read, 1408206994 more expected)', IncompleteRead(218622722 bytes read, 1408206994 more expected))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\tafnaz a\Documents\PLACEMENT TRAINING\Kidney-Disease-Classification\main.py", line 10, in <module>
    obj.main()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\pipeline\stage_01_data_ingestion.py", line 14, in main
    data_ingestion.download_file()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\components\data_ingestion.py", line 31, in download_file
    raise e
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\components\data_ingestion.py", line 26, in download_file
    gdown.download(prefix+file_id,zip_download_dir)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\gdown\download.py", line 368, in download
    for chunk in res.iter_content(chunk_size=CHUNK_SIZE):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\models.py", line 822, in generate
    raise ChunkedEncodingError(e)
requests.exceptions.ChunkedEncodingError: ('Connection broken: IncompleteRead(218622722 bytes read, 1408206994 more expected)', IncompleteRead(218622722 bytes read, 1408206994 more expected))
[2025-07-10 08:55:17,293: INFO: main: >>>>> stage Data Ingestion Stage started <<<<<<<]
[2025-07-10 08:55:17,299: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-10 08:55:17,304: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-10 08:55:17,309: INFO: common: craeted directory at:artifacts]
[2025-07-10 08:55:17,322: INFO: common: craeted directory at:artifacts/data_ingestion]
[2025-07-10 08:55:17,326: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-07-10 08:55:19,329: ERROR: main: HTTPSConnectionPool(host='doc-08-24-docs.googleusercontent.com', port=443): Max retries exceeded with url: /docs/securesc/ha0ro937gcuc7l7deffksulhg5h7mbp1/nbpr0g172etft53sf6dbp7vgrphqfm8u/1752117900000/14589950402045058757/*/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd?uuid=004fd390-74f8-4cf6-a3dd-7b5a33dc36b4 (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1016)')))]
Traceback (most recent call last):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\connection.py", line 790, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\connection.py", line 969, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
               ^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\util\ssl_.py", line 480, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(sock, context, tls_in_tls, server_hostname)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\util\ssl_.py", line 524, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\ssl.py", line 517, in wrap_socket
    return self.sslsocket_class._create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\ssl.py", line 1104, in _create
    self.do_handshake()
  File "C:\ProjectWork\envs\kidney\Lib\ssl.py", line 1382, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLCertVerificationError: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1016)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\connectionpool.py", line 488, in _make_request
    raise new_e
urllib3.exceptions.SSLError: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1016)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='doc-08-24-docs.googleusercontent.com', port=443): Max retries exceeded with url: /docs/securesc/ha0ro937gcuc7l7deffksulhg5h7mbp1/nbpr0g172etft53sf6dbp7vgrphqfm8u/1752117900000/14589950402045058757/*/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd?uuid=004fd390-74f8-4cf6-a3dd-7b5a33dc36b4 (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1016)')))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\tafnaz a\Documents\PLACEMENT TRAINING\Kidney-Disease-Classification\main.py", line 10, in <module>
    obj.main()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\pipeline\stage_01_data_ingestion.py", line 14, in main
    data_ingestion.download_file()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\components\data_ingestion.py", line 31, in download_file
    raise e
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\components\data_ingestion.py", line 26, in download_file
    gdown.download(prefix+file_id,zip_download_dir)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\gdown\download.py", line 202, in download
    res = sess.get(url, stream=True, verify=verify)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\sessions.py", line 724, in send
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\sessions.py", line 724, in <listcomp>
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\sessions.py", line 265, in resolve_redirects
    resp = self.send(
           ^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\adapters.py", line 698, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='doc-08-24-docs.googleusercontent.com', port=443): Max retries exceeded with url: /docs/securesc/ha0ro937gcuc7l7deffksulhg5h7mbp1/nbpr0g172etft53sf6dbp7vgrphqfm8u/1752117900000/14589950402045058757/*/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd?uuid=004fd390-74f8-4cf6-a3dd-7b5a33dc36b4 (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1016)')))[2025-07-18 21:08:13,373: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-18 21:08:13,393: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-18 21:08:13,398: INFO: common: craeted directory at:artifacts]
[2025-07-18 21:08:13,401: INFO: common: craeted directory at:artifacts/prepare_base_model]
[2025-07-18 21:09:17,447: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-18 21:09:17,454: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-18 21:09:17,457: INFO: common: craeted directory at:artifacts]
[2025-07-18 21:09:17,459: INFO: common: craeted directory at:artifacts/prepare_base_model]
[2025-07-18 21:11:00,478: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-18 21:11:00,507: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-18 21:11:00,510: INFO: common: craeted directory at:artifacts]
[2025-07-18 21:11:00,512: INFO: common: craeted directory at:artifacts/prepare_base_model]
[2025-07-18 21:39:00,281: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-18 21:39:00,285: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-18 21:39:00,288: INFO: common: craeted directory at:artifacts]
[2025-07-18 21:39:00,291: INFO: common: craeted directory at:artifacts/prepare_base_model]
[2025-07-18 21:39:34,913: WARNING: saving_utils: Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.]
[2025-07-18 22:08:33,711: INFO: main: >>>>> stage Data Ingestion Stage started <<<<<<<]
[2025-07-18 22:08:33,717: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-18 22:08:33,720: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-18 22:08:33,722: INFO: common: craeted directory at:artifacts]
[2025-07-18 22:08:33,739: INFO: common: craeted directory at:artifacts/data_ingestion]
[2025-07-18 22:08:33,741: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-07-18 22:17:37,123: ERROR: main: ('Connection broken: IncompleteRead(600386280 bytes read, 1026443436 more expected)', IncompleteRead(600386280 bytes read, 1026443436 more expected))]
Traceback (most recent call last):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 779, in _error_catcher
    yield
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 925, in _raw_read
    raise IncompleteRead(self._fp_bytes_read, self.length_remaining)
urllib3.exceptions.IncompleteRead: IncompleteRead(600386280 bytes read, 1026443436 more expected)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\models.py", line 820, in generate
    yield from self.raw.stream(chunk_size, decode_content=True)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 1091, in stream
    data = self.read(amt=amt, decode_content=decode_content)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 1008, in read
    data = self._raw_read(amt)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 903, in _raw_read
    with self._error_catcher():
  File "C:\ProjectWork\envs\kidney\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 803, in _error_catcher
    raise ProtocolError(arg, e) from e
urllib3.exceptions.ProtocolError: ('Connection broken: IncompleteRead(600386280 bytes read, 1026443436 more expected)', IncompleteRead(600386280 bytes read, 1026443436 more expected))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\tafnaz a\Documents\PLACEMENT TRAINING\Kidney-Disease-Classification\main.py", line 10, in <module>
    obj.main()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\pipeline\stage_01_data_ingestion.py", line 14, in main
    data_ingestion.download_file()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\components\data_ingestion.py", line 31, in download_file
    raise e
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\components\data_ingestion.py", line 26, in download_file
    gdown.download(prefix+file_id,zip_download_dir,fuzzy=True,resume=True)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\gdown\download.py", line 368, in download
    for chunk in res.iter_content(chunk_size=CHUNK_SIZE):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\models.py", line 822, in generate
    raise ChunkedEncodingError(e)
requests.exceptions.ChunkedEncodingError: ('Connection broken: IncompleteRead(600386280 bytes read, 1026443436 more expected)', IncompleteRead(600386280 bytes read, 1026443436 more expected))
[2025-07-18 22:17:56,369: INFO: main: >>>>> stage Data Ingestion Stage started <<<<<<<]
[2025-07-18 22:17:56,373: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-18 22:17:56,375: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-18 22:17:56,375: INFO: common: craeted directory at:artifacts]
[2025-07-18 22:17:56,377: INFO: common: craeted directory at:artifacts/data_ingestion]
[2025-07-18 22:17:56,378: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-07-18 22:17:56,392: ERROR: main: HTTPSConnectionPool(host='drive.google.com', port=443): Max retries exceeded with url: /uc?id=1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x000001B9685E5F10>: Failed to resolve 'drive.google.com' ([Errno 11001] getaddrinfo failed)"))]
Traceback (most recent call last):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\util\connection.py", line 60, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\socket.py", line 974, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno 11001] getaddrinfo failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\connectionpool.py", line 488, in _make_request
    raise new_e
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
                       ^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\connection.py", line 205, in _new_conn
    raise NameResolutionError(self.host, self, e) from e
urllib3.exceptions.NameResolutionError: <urllib3.connection.HTTPSConnection object at 0x000001B9685E5F10>: Failed to resolve 'drive.google.com' ([Errno 11001] getaddrinfo failed)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='drive.google.com', port=443): Max retries exceeded with url: /uc?id=1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x000001B9685E5F10>: Failed to resolve 'drive.google.com' ([Errno 11001] getaddrinfo failed)"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\tafnaz a\Documents\PLACEMENT TRAINING\Kidney-Disease-Classification\main.py", line 10, in <module>
    obj.main()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\pipeline\stage_01_data_ingestion.py", line 14, in main
    data_ingestion.download_file()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\components\data_ingestion.py", line 31, in download_file
    raise e
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\components\data_ingestion.py", line 26, in download_file
    gdown.download(prefix+file_id,zip_download_dir,fuzzy=True,resume=True)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\gdown\download.py", line 202, in download
    res = sess.get(url, stream=True, verify=verify)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='drive.google.com', port=443): Max retries exceeded with url: /uc?id=1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x000001B9685E5F10>: Failed to resolve 'drive.google.com' ([Errno 11001] getaddrinfo failed)"))
[2025-07-18 22:18:22,445: INFO: main: >>>>> stage Data Ingestion Stage started <<<<<<<]
[2025-07-18 22:18:22,448: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-18 22:18:22,451: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-18 22:18:22,452: INFO: common: craeted directory at:artifacts]
[2025-07-18 22:18:22,453: INFO: common: craeted directory at:artifacts/data_ingestion]
[2025-07-18 22:18:22,454: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-07-18 22:28:23,652: ERROR: main: ('Connection broken: IncompleteRead(828647686 bytes read, 197872270 more expected)', IncompleteRead(828647686 bytes read, 197872270 more expected))]
Traceback (most recent call last):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 779, in _error_catcher
    yield
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 925, in _raw_read
    raise IncompleteRead(self._fp_bytes_read, self.length_remaining)
urllib3.exceptions.IncompleteRead: IncompleteRead(828647686 bytes read, 197872270 more expected)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\models.py", line 820, in generate
    yield from self.raw.stream(chunk_size, decode_content=True)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 1091, in stream
    data = self.read(amt=amt, decode_content=decode_content)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 1008, in read
    data = self._raw_read(amt)
           ^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 903, in _raw_read
    with self._error_catcher():
  File "C:\ProjectWork\envs\kidney\Lib\contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\urllib3\response.py", line 803, in _error_catcher
    raise ProtocolError(arg, e) from e
urllib3.exceptions.ProtocolError: ('Connection broken: IncompleteRead(828647686 bytes read, 197872270 more expected)', IncompleteRead(828647686 bytes read, 197872270 more expected))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\tafnaz a\Documents\PLACEMENT TRAINING\Kidney-Disease-Classification\main.py", line 10, in <module>
    obj.main()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\pipeline\stage_01_data_ingestion.py", line 14, in main
    data_ingestion.download_file()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\components\data_ingestion.py", line 31, in download_file
    raise e
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\components\data_ingestion.py", line 26, in download_file
    gdown.download(prefix+file_id,zip_download_dir,fuzzy=True,resume=True)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\gdown\download.py", line 368, in download
    for chunk in res.iter_content(chunk_size=CHUNK_SIZE):
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\requests\models.py", line 822, in generate
    raise ChunkedEncodingError(e)
requests.exceptions.ChunkedEncodingError: ('Connection broken: IncompleteRead(828647686 bytes read, 197872270 more expected)', IncompleteRead(828647686 bytes read, 197872270 more expected))
[2025-07-18 22:29:01,086: INFO: main: >>>>> stage Data Ingestion Stage started <<<<<<<]
[2025-07-18 22:29:01,103: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-18 22:29:01,121: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-18 22:29:01,122: INFO: common: craeted directory at:artifacts]
[2025-07-18 22:29:01,123: INFO: common: craeted directory at:artifacts/data_ingestion]
[2025-07-18 22:29:01,123: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-07-18 22:30:25,413: INFO: data_ingestion: Downloaded data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-07-18 22:31:04,914: INFO: main: >>>>> stage Data Ingestion Stage completed <<<<<<<]
[2025-07-18 22:31:04,914: INFO: main: >>>>> stage Prepare base model started <<<<<<<]
[2025-07-18 22:31:04,917: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-18 22:31:04,921: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-18 22:31:04,922: INFO: common: craeted directory at:artifacts]
[2025-07-18 22:31:04,924: INFO: common: craeted directory at:artifacts/prepare_base_model]
[2025-07-18 22:31:05,942: WARNING: saving_utils: Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.]
[2025-07-18 22:31:06,391: INFO: main: >>>>> stage Prepare base model completed <<<<<<<]
[2025-07-19 12:28:27,656: INFO: main: >>>>> stage Data Ingestion Stage started <<<<<<<]
[2025-07-19 12:28:27,690: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-19 12:28:27,702: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-19 12:28:27,703: INFO: common: craeted directory at:artifacts]
[2025-07-19 12:28:27,704: INFO: common: craeted directory at:artifacts/data_ingestion]
[2025-07-19 12:28:27,705: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-07-19 12:28:31,211: INFO: data_ingestion: Downloaded data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-07-19 12:29:01,724: INFO: main: >>>>> stage Training started <<<<<<<]
[2025-07-19 12:29:01,728: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-19 12:29:01,730: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-19 12:29:01,731: INFO: common: craeted directory at:artifacts]
[2025-07-19 12:29:01,732: INFO: common: craeted directory at:artifacts\training]
[2025-07-19 12:49:44,345: ERROR: main: Graph execution error:

UnidentifiedImageError: cannot identify image file <_io.BytesIO object at 0x000001B207C0AF20>
Traceback (most recent call last):

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\tensorflow\python\ops\script_ops.py", line 267, in __call__
    ret = func(*args)
          ^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\tensorflow\python\autograph\impl\api.py", line 642, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\tensorflow\python\data\ops\from_generator_op.py", line 198, in generator_py_func
    values = next(generator_state.get_iterator(iterator_id))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\engine\data_adapter.py", line 902, in wrapped_generator
    for data in generator_fn():

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\engine\data_adapter.py", line 1049, in generator_fn
    yield x[i]
          ~^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\preprocessing\image.py", line 116, in __getitem__
    return self._get_batches_of_transformed_samples(index_array)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\preprocessing\image.py", line 370, in _get_batches_of_transformed_samples
    img = image_utils.load_img(
          ^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\utils\image_utils.py", line 423, in load_img
    img = pil_image.open(io.BytesIO(f.read()))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\PIL\Image.py", line 3580, in open
    raise UnidentifiedImageError(msg)

PIL.UnidentifiedImageError: cannot identify image file <_io.BytesIO object at 0x000001B207C0AF20>


	 [[{{node PyFunc}}]]
	 [[IteratorGetNext]] [Op:__inference_test_function_3629]]
Traceback (most recent call last):
  File "C:\Users\tafnaz a\Documents\PLACEMENT TRAINING\Kidney-Disease-Classification\main.py", line 30, in <module>
    obj.main()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\pipeline\stage_03_model_training.py", line 16, in main
    training.train()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\components\model_training.py", line 97, in train
    self.model.fit(
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\tensorflow\python\eager\execute.py", line 58, in quick_execute
    except TypeError as e:
tensorflow.python.framework.errors_impl.UnknownError: Graph execution error:

UnidentifiedImageError: cannot identify image file <_io.BytesIO object at 0x000001B207C0AF20>
Traceback (most recent call last):

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\tensorflow\python\ops\script_ops.py", line 267, in __call__
    ret = func(*args)
          ^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\tensorflow\python\autograph\impl\api.py", line 642, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\tensorflow\python\data\ops\from_generator_op.py", line 198, in generator_py_func
    values = next(generator_state.get_iterator(iterator_id))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\engine\data_adapter.py", line 902, in wrapped_generator
    for data in generator_fn():

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\engine\data_adapter.py", line 1049, in generator_fn
    yield x[i]
          ~^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\preprocessing\image.py", line 116, in __getitem__
    return self._get_batches_of_transformed_samples(index_array)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\preprocessing\image.py", line 370, in _get_batches_of_transformed_samples
    img = image_utils.load_img(
          ^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\utils\image_utils.py", line 423, in load_img
    img = pil_image.open(io.BytesIO(f.read()))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\PIL\Image.py", line 3580, in open
    raise UnidentifiedImageError(msg)

PIL.UnidentifiedImageError: cannot identify image file <_io.BytesIO object at 0x000001B207C0AF20>


	 [[{{node PyFunc}}]]
	 [[IteratorGetNext]] [Op:__inference_test_function_3629]
[2025-07-19 13:09:21,267: INFO: main: >>>>> stage Training started <<<<<<<]
[2025-07-19 13:09:21,273: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-19 13:09:21,290: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-19 13:09:21,292: INFO: common: craeted directory at:artifacts]
[2025-07-19 13:09:21,293: INFO: common: craeted directory at:artifacts\training]
[2025-07-19 13:09:22,136: ERROR: main: [WinError 3] The system cannot find the path specified: 'artifacts\\data_ingestion\\kidney-ct-scan-image']
Traceback (most recent call last):
  File "C:\Users\tafnaz a\Documents\PLACEMENT TRAINING\Kidney-Disease-Classification\main.py", line 30, in <module>
    obj.main()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\pipeline\stage_03_model_training.py", line 15, in main
    training.train_valid_generator()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\components\model_training.py", line 36, in train_valid_generator
    self.valid_generator = valid_datagenerator.flow_from_directory(
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\preprocessing\image.py", line 1648, in flow_from_directory
    return DirectoryIterator(
           ^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\preprocessing\image.py", line 563, in __init__
    for subdir in sorted(os.listdir(directory)):
                         ^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [WinError 3] The system cannot find the path specified: 'artifacts\\data_ingestion\\kidney-ct-scan-image'
[2025-07-19 13:10:19,561: INFO: main: >>>>> stage Training started <<<<<<<]
[2025-07-19 13:10:19,566: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-19 13:10:19,570: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-19 13:10:19,571: INFO: common: craeted directory at:artifacts]
[2025-07-19 13:10:19,572: INFO: common: craeted directory at:artifacts\training]
[2025-07-19 13:32:56,741: ERROR: main: Graph execution error:

UnidentifiedImageError: cannot identify image file <_io.BytesIO object at 0x0000025769AEE160>
Traceback (most recent call last):

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\tensorflow\python\ops\script_ops.py", line 267, in __call__
    ret = func(*args)
          ^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\tensorflow\python\autograph\impl\api.py", line 642, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\tensorflow\python\data\ops\from_generator_op.py", line 198, in generator_py_func
    values = next(generator_state.get_iterator(iterator_id))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\engine\data_adapter.py", line 902, in wrapped_generator
    for data in generator_fn():

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\engine\data_adapter.py", line 1049, in generator_fn
    yield x[i]
          ~^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\preprocessing\image.py", line 116, in __getitem__
    return self._get_batches_of_transformed_samples(index_array)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\preprocessing\image.py", line 370, in _get_batches_of_transformed_samples
    img = image_utils.load_img(
          ^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\utils\image_utils.py", line 423, in load_img
    img = pil_image.open(io.BytesIO(f.read()))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\PIL\Image.py", line 3580, in open
    raise UnidentifiedImageError(msg)

PIL.UnidentifiedImageError: cannot identify image file <_io.BytesIO object at 0x0000025769AEE160>


	 [[{{node PyFunc}}]]
	 [[IteratorGetNext]] [Op:__inference_test_function_3629]]
Traceback (most recent call last):
  File "C:\Users\tafnaz a\Documents\PLACEMENT TRAINING\Kidney-Disease-Classification\main.py", line 30, in <module>
    obj.main()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\pipeline\stage_03_model_training.py", line 16, in main
    training.train()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\components\model_training.py", line 75, in train
    self.model.fit(
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\tensorflow\python\eager\execute.py", line 58, in quick_execute
    except TypeError as e:
tensorflow.python.framework.errors_impl.UnknownError: Graph execution error:

UnidentifiedImageError: cannot identify image file <_io.BytesIO object at 0x0000025769AEE160>
Traceback (most recent call last):

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\tensorflow\python\ops\script_ops.py", line 267, in __call__
    ret = func(*args)
          ^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\tensorflow\python\autograph\impl\api.py", line 642, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\tensorflow\python\data\ops\from_generator_op.py", line 198, in generator_py_func
    values = next(generator_state.get_iterator(iterator_id))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\engine\data_adapter.py", line 902, in wrapped_generator
    for data in generator_fn():

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\engine\data_adapter.py", line 1049, in generator_fn
    yield x[i]
          ~^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\preprocessing\image.py", line 116, in __getitem__
    return self._get_batches_of_transformed_samples(index_array)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\preprocessing\image.py", line 370, in _get_batches_of_transformed_samples
    img = image_utils.load_img(
          ^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\keras\utils\image_utils.py", line 423, in load_img
    img = pil_image.open(io.BytesIO(f.read()))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\ProjectWork\envs\kidney\Lib\site-packages\PIL\Image.py", line 3580, in open
    raise UnidentifiedImageError(msg)

PIL.UnidentifiedImageError: cannot identify image file <_io.BytesIO object at 0x0000025769AEE160>


	 [[{{node PyFunc}}]]
	 [[IteratorGetNext]] [Op:__inference_test_function_3629]
[2025-07-19 13:33:38,099: INFO: main: >>>>> stage Training started <<<<<<<]
[2025-07-19 13:33:38,103: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-07-19 13:33:38,106: INFO: common: yaml file: params.yaml loaded successfully]
[2025-07-19 13:33:38,107: INFO: common: craeted directory at:artifacts]
[2025-07-19 13:33:38,108: INFO: common: craeted directory at:artifacts\training]
[2025-08-11 20:43:51,718: INFO: main: >>>>> stage Data Ingestion Stage started <<<<<<<]
[2025-08-11 20:43:51,722: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-08-11 20:43:51,738: INFO: common: yaml file: params.yaml loaded successfully]
[2025-08-11 20:43:51,740: INFO: common: craeted directory at:artifacts]
[2025-08-11 20:43:51,741: INFO: common: craeted directory at:artifacts/data_ingestion]
[2025-08-11 20:43:51,743: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-08-11 20:53:40,550: INFO: data_ingestion: Downloaded data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-08-11 20:54:12,838: INFO: main: >>>>> stage Data Ingestion Stage completed <<<<<<<]
[2025-08-11 20:54:12,838: INFO: main: >>>>> stage Prepare base model started <<<<<<<]
[2025-08-11 20:54:12,843: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-08-11 20:54:12,846: INFO: common: yaml file: params.yaml loaded successfully]
[2025-08-11 20:54:12,847: INFO: common: craeted directory at:artifacts]
[2025-08-11 20:54:12,849: INFO: common: craeted directory at:artifacts/prepare_base_model]
[2025-08-11 20:54:13,848: WARNING: saving_utils: Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.]
[2025-08-11 20:54:14,193: INFO: main: >>>>> stage Prepare base model completed <<<<<<<]
[2025-08-11 20:54:14,194: INFO: main: >>>>> stage Training started <<<<<<<]
[2025-08-11 20:54:14,197: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-08-11 20:54:14,199: INFO: common: yaml file: params.yaml loaded successfully]
[2025-08-11 20:54:14,200: INFO: common: craeted directory at:artifacts]
[2025-08-11 20:54:14,201: INFO: common: craeted directory at:artifacts\training]
[2025-08-11 21:17:11,487: INFO: main: >>>>> stage Training completed <<<<<<<]
[2025-08-12 19:29:18,582: INFO: stage_01_data_ingestion: >>>>> stage Data Ingestion Stage started <<<<<<<]
[2025-08-12 19:29:18,583: ERROR: stage_01_data_ingestion: DataIngestionTrainingPipeline.main() missing 1 required positional argument: 'self']
Traceback (most recent call last):
  File "C:\Users\tafnaz a\Documents\PLACEMENT TRAINING\Kidney-Disease-Classification\src\cnnClassfier\pipeline\stage_01_data_ingestion.py", line 21, in <module>
    obj.main()
TypeError: DataIngestionTrainingPipeline.main() missing 1 required positional argument: 'self'
[2025-08-12 19:30:00,191: INFO: stage_01_data_ingestion: >>>>> stage Data Ingestion Stage started <<<<<<<]
[2025-08-12 19:30:00,192: ERROR: stage_01_data_ingestion: DataIngestionTrainingPipeline.main() missing 1 required positional argument: 'self']
Traceback (most recent call last):
  File "C:\Users\tafnaz a\Documents\PLACEMENT TRAINING\Kidney-Disease-Classification\src\cnnClassfier\pipeline\stage_01_data_ingestion.py", line 21, in <module>
    obj.main()
TypeError: DataIngestionTrainingPipeline.main() missing 1 required positional argument: 'self'
[2025-08-12 19:33:32,905: INFO: stage_01_data_ingestion: >>>>> stage Data Ingestion Stage started <<<<<<<]
[2025-08-12 19:33:32,910: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-08-12 19:33:32,914: INFO: common: yaml file: params.yaml loaded successfully]
[2025-08-12 19:33:32,916: INFO: common: craeted directory at:artifacts]
[2025-08-12 19:33:32,917: INFO: common: craeted directory at:artifacts/data_ingestion]
[2025-08-12 19:33:32,918: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-08-12 19:46:44,855: INFO: data_ingestion: Downloaded data from https://drive.google.com/file/d/1Vqh5Kn5aNg9qM2XMi3uvbwxaB9GJMpvd/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-08-12 19:47:24,286: INFO: stage_01_data_ingestion: >>>>> stage Data Ingestion Stage completed <<<<<<<]
[2025-08-12 19:51:41,034: INFO: stage_02_prepare_base_model: >>>>> stage Prepare base model started <<<<<<<]
[2025-08-12 19:51:41,054: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-08-12 19:51:41,057: INFO: common: yaml file: params.yaml loaded successfully]
[2025-08-12 19:51:41,058: INFO: common: craeted directory at:artifacts]
[2025-08-12 19:51:41,059: INFO: common: craeted directory at:artifacts/prepare_base_model]
[2025-08-12 19:51:42,005: WARNING: saving_utils: Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.]
[2025-08-12 19:51:42,337: INFO: stage_02_prepare_base_model: >>>>> stage Prepare base model completed <<<<<<<]
[2025-08-12 19:52:02,233: INFO: stage_03_model_training: >>>>> stage Training started <<<<<<<]
[2025-08-12 19:52:02,236: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-08-12 19:52:02,239: INFO: common: yaml file: params.yaml loaded successfully]
[2025-08-12 19:52:02,240: INFO: common: craeted directory at:artifacts]
[2025-08-12 19:52:02,241: INFO: common: craeted directory at:artifacts\training]
[2025-08-12 21:02:05,409: INFO: stage_03_model_training: >>>>> stage Training completed <<<<<<<]
[2025-08-12 21:02:30,714: INFO: stage_04_model_evaluation: >>>>> stage Evaluation stage started <<<<<<<]
[2025-08-12 21:02:30,718: INFO: common: yaml file: config\config.yaml loaded successfully]
[2025-08-12 21:02:30,721: INFO: common: yaml file: params.yaml loaded successfully]
[2025-08-12 21:02:30,722: INFO: common: craeted directory at:artifacts]
[2025-08-12 21:09:09,254: INFO: common: json file saved at: scores.json]
[2025-08-12 21:09:12,093: WARNING: save: Found untraced functions such as _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op, _jit_compiled_convolution_op while saving (showing 5 of 14). These functions will not be directly callable after loading.]
[2025-08-12 21:09:13,068: INFO: builder_impl: Assets written to: C:\Users\TAFNAZ~1\AppData\Local\Temp\tmp4x7sys9p\model\data\model\assets]
[2025-08-12 21:09:41,634: ERROR: stage_04_model_evaluation: No module named 'distutils._modified']
Traceback (most recent call last):
  File "C:\Users\tafnaz a\Documents\PLACEMENT TRAINING\Kidney-Disease-Classification\src\cnnClassfier\pipeline\stage_04_model_evaluation.py", line 21, in <module>
    obj.main()
  File "C:\Users\tafnaz a\Documents\PLACEMENT TRAINING\Kidney-Disease-Classification\src\cnnClassfier\pipeline\stage_04_model_evaluation.py", line 15, in main
    evaluation.log_into_mlflow()
  File "c:\users\tafnaz a\documents\placement training\kidney-disease-classification\src\cnnClassfier\components\model_evaluation.py", line 72, in log_into_mlflow
    mlflow.keras.log_model(self.model, "model")
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\mlflow\tensorflow\__init__.py", line 222, in log_model
    return Model.log(
           ^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\mlflow\models\model.py", line 552, in log
    mlflow.tracking.fluent.log_artifacts(local_path, mlflow_model.artifact_path)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\mlflow\tracking\fluent.py", line 817, in log_artifacts
    MlflowClient().log_artifacts(run_id, local_dir, artifact_path)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\mlflow\tracking\client.py", line 1069, in log_artifacts
    self._tracking_client.log_artifacts(run_id, local_dir, artifact_path)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 448, in log_artifacts
    self._get_artifact_repo(run_id).log_artifacts(local_dir, artifact_path)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\mlflow\store\artifact\local_artifact_repo.py", line 58, in log_artifacts
    dir_util.copy_tree(src=local_dir, dst=artifact_dir, preserve_mode=0, preserve_times=0)
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\setuptools\_distutils\dir_util.py", line 150, in copy_tree
    return list(itertools.chain.from_iterable(map(copy_one, names)))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\setuptools\_distutils\dir_util.py", line 192, in _copy_one
    file_util.copy_file(
  File "C:\ProjectWork\envs\kidney\Lib\site-packages\setuptools\_distutils\file_util.py", line 104, in copy_file
    from distutils._modified import newer
ModuleNotFoundError: No module named 'distutils._modified'
